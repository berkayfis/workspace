@using Microsoft.AspNetCore.Http;
@{
	ViewData["Title"] = "Index";
	if (Context.Session.GetInt32("mail") == 0)
	{
		Context.Session.SetInt32("mail", 2);
		<div class="sufee-alert alert with-close alert-danger alert-dismissible fade show">
			<span class="badge badge-pill badge-danger">Gönderilemedi</span>
			Hata oluştu...
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">×</span>
			</button>
		</div>
	}
	else if (Context.Session.GetInt32("mail") == 1)
	{
		Context.Session.SetInt32("mail", 2);
		<div class="sufee-alert alert with-close alert-success alert-dismissible fade show">
			<span class="badge badge-pill badge-success">Gönderildi</span>
			Başarılı bir şekilde gönderildi.
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">×</span>
			</button>
		</div>
	}
}

<div class="row">
	<div class="col-lg-12">
		<!-- USER DATA-->
		<div class="user-data m-b-30">
			<h3 class="title-3 m-b-30">
				<i class="zmdi zmdi-account-calendar"></i>Mesajlaşma Geçmişi
			</h3>
			<div class="table-responsive table-data">
                <table class="table">
                    <thead>
                        <tr>
                            @if (User.Identity.AuthenticationType == "Akademisyen Claims")
                            {
                                <td>Öğrenci Ad Soyad</td>
                            }
                            else
                            {
                                <td>Akademisyen</td>
                            }
                            <td>Konuşmayı Göster</td>
                        </tr>
                    </thead>
                    <tbody>
                        @if (User.Identity.AuthenticationType == "Akademisyen Claims")
                        {
                            foreach (Ogrenci ogrenci in ViewBag.MessageUsers)
                            {
                                <tr>
                                    <td>
                                        @ogrenci.Ad @ogrenci.Soyad
                                    </td>
                                    <td>
                                        <a asp-controller="Chat" asp-action="ChatHistory" asp-route-guid="@ogrenci.MessageId">Konuşmayı Göster</a>
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            foreach (AkademikPersonel akademisyen in ViewBag.MessageUsers)
                            {
                                <tr>
                                    <td>
                                        @akademisyen.Ad @akademisyen.Soyad
                                    </td>
                                    <td>
                                        <a asp-controller="Chat" asp-action="ChatHistory" asp-route-guid="@akademisyen.MessageId" >Konuşmayı Göster</a>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                    </table>
			</div>
		</div>
		<!-- END USER DATA-->
	</div>
    <div>
        <a class="btn btn-success" href="/Chat/SendEmail">Yeni Mesaj Gönder</a>
    </div>

</div>